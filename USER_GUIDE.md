# ペット健康免許証生成サービス 使い方ガイド

本ガイドでは、ペット健康免許証生成サービスの各画面の使い方を説明します。

---

## 目次

1. [一般ユーザー向け画面](#1-一般ユーザー向け画面)
2. [イベント運営者向け画面](#2-イベント運営者向け画面)
3. [管理者向け画面](#3-管理者向け画面)

---

## 1. 一般ユーザー向け画面

### 1.1 イベント用入力画面 (`/event/:eventCode`)

イベント運営者から共有されたURLにアクセスすると、この画面が表示されます。

#### 画面フロー

```
ペット画像をアップロード
        ↓
    AI自動分析
        ↓
   免許証プレビュー表示
        ↓
   情報を編集（任意）
        ↓
  「免許証をアップロード」
        ↓
    受付完了画面
```

#### 1.1.1 ステップ1: 画像のアップロード

1. 画面中央のアップロードエリアをクリック、またはドラッグ&ドロップでペット画像を選択
2. 選択すると自動的にAI分析が開始されます
   - **AI分析中...** → ペットの種類・品種・毛色を自動判別
   - **プロフィール生成中...** → AIがペットに合った名前や特徴を自動生成
   - **免許証を生成中...** → 免許証画像をリアルタイムで生成

#### 1.1.2 ステップ2: 免許証の確認と編集

免許証が生成されると、画面上部にプレビューが表示されます。

**重要: 免許証画像のエリアをクリックすると、対応する入力欄に移動して編集できます**

クリック可能なエリア:
- **ペット名（氏名欄）** - 画像上部のペット名エリアをクリック
- **生年月日** - 右上の生年月日エリアをクリック
- **性別** - 左側の性別エリアをクリック
- **種類** - 左側の品種エリアをクリック
- **毛色** - 左側の毛色エリアをクリック
- **飼い主名（保護者欄）** - 左側の保護者エリアをクリック
- **お好きな一言** - 中央下部の一言エリアをクリック
- **マイクロチップNo** - 下部のマイクロチップエリアをクリック
- **特記事項** - 右側の特記事項エリアをクリック

入力フォームで値を変更すると、免許証画像がリアルタイムで更新されます。

#### 1.1.3 ステップ3: アップロード

1. 「**免許証をアップロード**」ボタンをクリック
2. アップロードが完了すると、受付完了画面が表示されます
3. **受付番号**が発行されるので、控えとして保存してください

#### 1.1.4 受付完了後

- 「**免許証をダウンロード**」で画像を保存できます
- 「**新しい免許証を作成**」で最初からやり直せます

---

## 2. イベント運営者向け画面

### 2.1 印刷用画面 (`/print` または `/print?code=イベントコード`)

イベント会場で免許証を印刷するための専用画面です。

#### 2.1.1 イベントコードの入力

1. `/print` にアクセス
2. 管理者から共有されたイベントコードを入力
3. 「**表示**」ボタンをクリック

または、URLにイベントコードを含めて直接アクセス:
```
/print?code=ABC123
```

#### 2.1.2 免許証一覧の表示

イベントコードが認証されると、そのイベントで作成された免許証の一覧が表示されます。

- **自動更新機能**: 5秒間隔で新しい免許証を自動取得
- **新着表示**: 新しく追加された免許証の件数を表示
- **ページネーション**: 20件ずつ表示、ページ切り替え可能

#### 2.1.3 免許証の印刷

1. 一覧から印刷したい免許証カードをクリック
2. 詳細モーダルが開きます
3. 「**印刷**」ボタンをクリック
4. 印刷ダイアログが開きます（名刺サイズ 85mm x 54mm に最適化）

#### 2.1.4 画面の見方

| 要素 | 説明 |
|------|------|
| 受付番号バッジ | `#001` のように表示。ユーザーが受け取った番号と一致 |
| 自動更新: ON | リアルタイムで新規免許証を取得中 |
| +N件 新着 | 最後の確認から新たに追加された件数 |
| ← 戻る | イベントコード入力画面に戻る |

---

## 3. 管理者向け画面

### 3.1 管理者ログイン (`/admin`)

管理機能にアクセスするためのログイン画面です。

1. ユーザー名とパスワードを入力
2. 「**ログイン**」ボタンをクリック
3. 認証成功後、イベント管理画面に遷移

**初期管理者アカウント:**
- ユーザー名: `admin`
- パスワード: `admin123`

※ 本番環境では必ずパスワードを変更してください

---

### 3.2 イベント管理画面 (`/admin/events`)

イベントの一覧表示と新規作成を行う画面です。

#### 3.2.1 イベント一覧

登録されているイベントがカード形式で表示されます。

各カードに表示される情報:
- **イベント名**
- **ステータス**: 有効 / 無効
- **交付場所**
- **交付日**: 固定日付 or 自動（アクセス日）
- **イベントコード**
- **ユーザー用URL**: コピー可能

#### 3.2.2 新規イベント作成

1. 「**+ 新規イベント作成**」ボタンをクリック
2. モーダルで以下を入力:
   - **イベント名**: イベントの表示名
   - **交付場所**: 免許証に表示される場所
   - **交付日を自動にする**: チェックすると、ユーザーがアクセスした日が交付日になります
   - **交付日**: 固定の日付を指定（自動が無効の場合）
3. 「**作成**」ボタンをクリック

#### 3.2.3 イベント詳細へ

イベントカードをクリックすると、詳細画面に遷移します。

---

### 3.3 イベント詳細画面 (`/admin/events/:id`)

特定のイベントの詳細情報と、発行された免許証の管理を行う画面です。

#### 3.3.1 イベント情報

画面左側に以下の情報が表示されます:
- イベント名、ステータス
- イベントコード
- 交付場所、交付日
- 作成日

**操作ボタン:**
- **編集**: イベント情報を変更
- **有効にする / 無効にする**: ステータス切り替え
- **削除**: イベントを削除（確認ダイアログあり）

#### 3.3.2 QRコード

画面右側にイベント用URLのQRコードが表示されます。
- QRコードを印刷してイベント会場に掲示
- 来場者がスキャンしてアクセス
- URLをコピーしてSNS等で共有も可能

#### 3.3.3 免許証一覧

画面下部に、このイベントで作成された免許証の一覧が表示されます。

- **自動更新**: 5秒間隔で新規免許証を自動取得
- **ページネーション**: 20件ずつ表示
- **カードクリック**: 詳細モーダルを開く

#### 3.3.4 免許証詳細モーダル

免許証カードをクリックすると詳細が表示されます:
- 免許証画像（フルサイズ）
- 受付番号
- ペット情報（名前、飼い主、動物種別、品種、毛色など）
- AI生成情報（お好きな一言、好きな食べ物など）
- 作成日時

**操作:**
- **ダウンロード**: 免許証画像を保存
- **削除**: 免許証を削除（確認ダイアログあり）

---

## 画面遷移図

```
[一般ユーザー]
    イベントURL (/event/:code)
         ↓
    画像アップロード → AI分析 → 免許証プレビュー → アップロード → 受付完了


[イベント運営者]
    /print
         ↓
    イベントコード入力 → 免許証一覧 → 詳細表示 → 印刷


[管理者]
    /admin
         ↓
    ログイン → イベント一覧 → イベント詳細
                    ↓               ↓
              新規イベント作成   免許証管理
                                    ↓
                              免許証詳細/削除
```

---

## Tips

### 画像クリックで編集

ユーザー画面では、免許証プレビュー画像の各エリアをクリックすると、対応する入力フィールドに自動でスクロールしてフォーカスが当たります。これにより、修正したい項目を直感的に編集できます。

### リアルタイム更新

- フォームで値を変更すると、免許証画像が自動的に再生成されます（約0.3秒後）
- 印刷画面と管理画面では、5秒間隔で新規データを自動取得します

### 受付番号

受付番号はイベントごとに1から連番で発行されます。印刷時にユーザーに渡した受付番号と照合することで、正しい免許証を渡すことができます。

---

## よくある質問

### Q: 免許証の情報を間違えた場合は？

A: アップロード前であれば、フォームで修正できます。アップロード後は、管理画面から削除して、ユーザーに再度作成してもらってください。

### Q: イベントを無効にするとどうなりますか？

A: イベントURLにアクセスしても「このURLは現在無効です」と表示され、新規の免許証は作成できなくなります。既存の免許証データは保持されます。

### Q: 印刷用紙のサイズは？

A: 名刺サイズ（85mm x 54mm）に最適化されています。印刷ダイアログで用紙サイズを名刺に設定してください。
